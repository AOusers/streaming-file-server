buildscript {
    ext {
        baseName = 'streaming-file-server'

        environmentFileDir = 'gradle'
        propertiesPluginEnvironmentNameProperty = 'env'

        commonsIoVer = '1.3.2'
        jqueryVer = '2.2.2'
        bootstrapVer = '3.3.6'
        bootstrapFileInputVer = '4.3.1'
        fontAwesomeVer = '4.5.0'
        powermockitoVer = '1.6.4'
        jgivenVer = '0.11.3'
        webjarsLocatorVer = '0.30'
    }
}

plugins {
    id 'java'
    id 'idea'
    id 'application'
    id 'cn.bestwu.propdeps' version '0.0.10'
    id 'cn.bestwu.propdeps-idea' version '0.0.10'
    id 'cn.bestwu.propdeps-maven' version '0.0.10'
    id 'cn.bestwu.propdeps-eclipse' version '0.0.10'
    id 'org.springframework.boot' version '1.5.3.RELEASE'
    id 'io.spring.dependency-management' version '1.0.2.RELEASE'
    id 'com.github.ben-manes.versions' version '0.14.0'
    id 'net.saliman.properties' version '1.4.6'
}

version '1.0.0'
group 'com.daggerok.spring'
sourceCompatibility = targetCompatibility = JavaVersion.VERSION_1_8

repositories {
    jcenter()
    mavenCentral()
}

dependencies {
    compile 'org.springframework.boot:spring-boot-starter-mustache',
            'org.springframework.boot:spring-boot-starter-data-rest',
            'org.springframework.boot:spring-boot-starter-data-jpa',
            'org.springframework.boot:spring-boot-starter-hateoas',
            'org.springframework.social:spring-social-facebook',
            'com.fasterxml.jackson.core:jackson-databind',
            'com.fasterxml.jackson.datatype:jackson-datatype-jsr310:2.8.8',
            "org.apache.commons:commons-io:$commonsIoVer",
            'com.h2database:h2',

            'org.springframework.data:spring-data-rest-hal-browser',
            'org.springframework.boot:spring-boot-devtools',
            'org.projectlombok:lombok',

            "org.webjars:webjars-locator:$webjarsLocatorVer",
            "org.webjars:jquery:$jqueryVer",
            "org.webjars:bootstrap:$bootstrapVer",
            "org.webjars.bower:bootstrap-fileinput:$bootstrapFileInputVer",
            "org.webjars.bower:font-awesome:$fontAwesomeVer"

    testCompile 'org.springframework.boot:spring-boot-starter-test',
                "org.powermock:powermock-module-junit4:$powermockitoVer",
                "org.powermock:powermock-api-mockito:$powermockitoVer",
                "com.tngtech.jgiven:jgiven-junit:$jgivenVer",
                "com.tngtech.jgiven:jgiven-html5-report:$jgivenVer"
}

dependencyManagement {
    imports {
        mavenBom 'org.springframework.boot:spring-boot-starter-parent:1.5.3.RELEASE'
    }
}

bootRun { systemProperties = System.properties }

task jgiven(type: JavaExec, dependsOn: 'test') {
    main = 'com.tngtech.jgiven.report.ReportGenerator'
    args '--targetDir=./jgiven-reports/html', '--format=html'
    classpath = configurations.testCompile
}
